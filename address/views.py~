#! /usr/bin/env python
#coding=utf-8
from django.http import HttpResponseRedirect
from django.shortcuts import render_to_response
from django.views.decorators.csrf import csrf_protect
from accounts.forms import AddressForm
from address.models import Address
from django.template import RequestContext
from django.views.generic import ListView


@csrf_protect
def add(request):
    if request.method =='POST':
        form=AddressForm(request.POST)
        if form.is_valid():
            address = form.save(commit=False)
            address.user = request.user
            address.save()
            return HttpResponseRedirect('/address/')
    else:
        form=AddressForm()
    return render_to_response('address_form.html', {
    'form': form},
    context_instance=RequestContext(request),
    )


class AddressListView(ListView):
    context_object_name="address_list"
    template_name="address_list.html"

    def get_queryset(self):
            return Address.objects.filter(user=self.request.user)
